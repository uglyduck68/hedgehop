NAME = condor_starter.std
all_target($(NAME))

#ifndef DOES_CHECKPOINTING
CKPT_FLAG = -DNO_CKPT
#endif
CFLAGS = $(STD_C_FLAGS) $(CKPT_FLAG) $(CONFIGURE_PCRE_CFLAGS)
C_PLUS_FLAGS = $(STD_C_PLUS_FLAGS) $(CKPT_FLAG) $(CONFIGURE_PCRE_CFLAGS)

IMPORT_LINKS = ../../config/import_links
import_objs(../condor_syscall_lib,file_stream.o)

REMOTE_SYSCALL_OBJ = \
	../condor_ckpt/signals_control.o \
	../condor_ckpt/syscall_mode.o \
	../condor_syscall_lib/remote_syscall.o \
	../condor_syscall_lib/senders.o \
	../condor_syscall_lib/syscall_connect.o \
	../condor_syscall_lib/syscall_numbers.o \
	../condor_syscall_lib/xfer_file.o

LIB = $(STD_LIBS) $(CONFIGURE_PCRE_LDFLAGS)

CLASS_LIB_OBJ = alarm.o

PORTABLE_OBJ = $(CLASS_LIB_OBJ) signals.o \
	user_proc.o tables.o starter_common.o file_stream.o 

NON_PORTABLE_OBJ = NON_POSIX.o analyze_core.o

OBJ = starter_main.o $(PORTABLE_OBJ) $(NON_PORTABLE_OBJ) $(REMOTE_SYSCALL_OBJ)

public_c_plus_target($(NAME),sbin,$(OBJ),$(LIB))

html:
testbin:: all

starter_state_diagram.dot: $(NAME)
	./$(NAME) -dot > starter_state_diagram.dot

starter_state_diagram.ps: starter_state_diagram.dot
	dot -Tps -Gsize="10,9" -Gratio=.75 -Gorientation=landscape \
	starter_state_diagram.dot > starter_state_diagram.ps
