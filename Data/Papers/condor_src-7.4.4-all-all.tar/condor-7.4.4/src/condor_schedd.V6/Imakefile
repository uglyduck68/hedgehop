NAME = condor_schedd
all_target(libqmgmt.a $(NAME))

C_PLUS_FLAGS = -I../condor_daemon_core.V6 $(STD_C_PLUS_FLAGS) $(CONFIGURE_PCRE_CFLAGS)
CFLAGS =  -I../condor_daemon_core.V6 $(STD_C_FLAGS) $(CONFIGURE_PCRE_CFLAGS)

LIB= $(DAEMONCORE_LIB) $(STD_LIBS) $(CONFIGURE_GSOAP_LDFLAGS) $(CONFIGURE_PCRE_LDFLAGS)

QMGMT_OBJ = qmgmt.o qmgmt_receivers.o qmgmt_common.o \
	schedd_files.o ickpt_share.o
QMGMT_LIB_OBJ = qmgmt_send_stubs.o qmgr_lib_support.o qmgmt_common.o \
	qmgr_job_updater.o

soapobjs(schedd)

#if HAVE_DLOPEN
ScheddPluginObj = ScheddPluginManager.o

%-plugin.so: %.cpp
	$(CPlusPlus) $(C_PLUS_FLAGS) -shared $< -o $@
#endif

#ifdef HAVE_EXT_GSOAP
SOAP_OBJS2 = loose_file_transfer.o schedd_api.o $(SOAP_OBJS)
#endif

OBJ = schedd.o schedd_main.o schedd_td.o tdman.o $(QMGMT_OBJ) \
	 \
	schedd_cronmgr.o schedd_cronjob.o \
	dedicated_scheduler.o grid_universe.o shadow_mgr.o autocluster.o \
	transfer_queue.o \
	$(ScheddPluginObj) \
	$(SOAP_OBJS2)

#ifdef HAVE_EXT_GSOAP
schedd_api.cpp: soap_scheddH.h ../condor_c++_util/soap_helpers.cpp

soap_scheddStub.cpp: ../condor_c++_util/soap_helpers.cpp

#endif

$(QMGMT_LIB) : libqmgmt.a

library_target(libqmgmt.a,$(QMGMT_LIB_OBJ))

public_c_plus_target($(NAME),sbin,$(OBJ),$(LIB))

c_plus_target(qmgr_test,qmgr_test.o libqmgmt.a,$(LIB))

html_target( documentation )

gen_soapfiles(schedd,condorSchedd)

testbin:: all

