AC_INIT

AC_ARG_WITH([cream],AC_HELP_STRING([--with-cream],[where is cream]),
            ac_cv_use_cream=$withval,[ac_cv_use_cream=no])
AC_SUBST(cream,$ac_cv_use_cream)

AC_ARG_WITH([static],AC_HELP_STRING([--with-static],[build a static gahp]),
            ac_cv_build_static=$withval,[ac_cv_build_static=NO])
AC_SUBST(build_static,$ac_cv_build_static)

AC_MSG_CHECKING([platform])
os=`uname -s | sed 's/IRIX.*/IRIX/'`
AC_MSG_RESULT([$os])
AC_SUBST(platform,$os)

# This is a little lame, but for now, we'll just hard-code this
AC_MSG_CHECKING([If we need special flags for the cream libraries])
if test $os = "AIX" ; then
  AC_MSG_RESULT([yes])
  ac_pre_cream_libs="-Wl,-bstatic"
  ac_post_cream_libs="-Wl,-bdynamic"
  AC_MSG_CHECKING([flags before cream libraries])
  AC_MSG_RESULT([$ac_pre_cream_libs])
  AC_MSG_CHECKING([flags after cream libraries])
  AC_MSG_RESULT([$ac_post_cream_libs])
  AC_SUBST(PRE_CREAM_LIBS,$ac_pre_cream_libs)
  AC_SUBST(POST_CREAM_LIBS,$ac_post_cream_libs)
else
  AC_MSG_RESULT([no])
  AC_SUBST(PRE_CREAM_LIBS,[""])
  AC_SUBST(POST_CREAM_LIBS,[""])
fi

AC_CHECK_FUNCS([unsetenv])
AC_CHECK_FUNC(gethostent, ,AC_CHECK_LIB(nsl, gethostent))
AC_CHECK_FUNC(setsockopt, ,AC_CHECK_LIB(socket, setsockopt))
AC_CHECK_FUNC(dlopen, ,AC_CHECK_LIB(dl, dlopen))
AC_CHECK_FUNC(log10, ,AC_CHECK_LIB(m, log10))
AC_CHECK_FUNC(pow, ,AC_CHECK_LIB(m, pow))
AC_CHECK_FUNC(ceil, ,AC_CHECK_LIB(m, ceil))
AC_CHECK_FUNC(basename, ,AC_CHECK_LIB(gen, basename))


AC_OUTPUT(Makefile)
